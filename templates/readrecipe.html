{% extends 'base.html'%}
{% block content %}
<div class="recipeWrapper">
    <div class="recipeHeader">
        <div id="readRecipeTitle" class="recipeHeaderItem">{{recipe.title}}</div>
        <div id="dishType" class="recipeHeaderItem">{{recipe.dish_type}}</div>
        <div id="showReviewsPopupBtn" class="recipeHeaderItem">Reviews</div>
        {% if session["username"]!="" %}
        <div id="showRatePopupBtn" class="recipeHeaderItem">Rate This One!</div>
        {% endif %}
        {% if session["username"]!="" and recipe.user_email_hash==session["email_address"] %}
        <div class="recipeHeaderItem"><a href="{{url_for('edit_recipe', recipe_id=recipe._id)}}">Edit</a></div>
        <div class="recipeHeaderItem"><a href="{{url_for('delete_recipe', recipe_id=recipe._id)}}">Delete</a></div>
        {% endif %}
    </div>

    <div id="outerStatsWrapper">
        <div class="statsWrapper">
            <div class="statsfield">Added By:</div>
            <div class="statsfield">{{recipe.added_by}}</div>
        </div>

        <div class="statsWrapper">
            <div class="statsfield">Date added:</div>
            <div class="statsfield">{{recipe.added_on_date}}</div>
        </div>

        <div class="statsWrapper">
            <div class="statsfield">Time added:</div>
            <div class="statsfield">{{recipe.added_on_time}}</div>
        </div>

        <div class="statsWrapper">
            <div class="statsfield">Level:</div>
            <div class="statsfield">{{recipe.level}}</div>
        </div>

        <div class="statsWrapper">
            <div class="statsfield">Reviews:</div>
            <div class="statsfield">{{recipe.review_count}}</div>
        </div>

        <div class="statsWrapper">
            <div class="statsfield">Viewed:</div>
            <div class="statsfield">{{recipe.view_count}}</div>
        </div>
        <div class="outerTimesWrapper">
            <div class="timesWrapper">
                <div class="directionsLabel">Prep Time:</div>
                <div class="prepTime">{{recipe.prep_time}}</div>
            </div>
            <div class="timesWrapper">
                <div class="directionsLabel">Cooking Time:</div>
                <div class="cookingTime">{{recipe.cooking_time}}</div>
            </div>
            <div class="timesWrapper">
                <div class="directionsLabel">Total Time:</div>
                <div class="totalTime">{{recipe.total_time}}</div>
            </div>
        </div>
    </div>

    <div id="dishImageWrapper">
        <div id="origin">
            <img id="originFlag" src="{{recipe.origin}}">
        </div>
        <img id="dishImage" src="{{recipe.img_src}}" style="width:100%;height:100%;" alt="image of dish">
    </div>


    <div id="outerIngredientsWrapper">
        <div class="amount">100g</div>
        <div class="ingredient">Spinat</div>
    </div>

    <div id="outerDirectionsWrapper">
        <div class="directions">
            {{recipe.directions}}
        </div>
    </div>
</div>
{% endblock %}


{% block popups %}
<div id="reviewsPopup">
    <div id="reviewsWrapper">
        {% for review in reviews_of_recipe %}
        <div class="reviewContainer">
            <div class="reviewlines">{{review.review_title}}</div>
            <div class="reviewlines">{{review.review_for}}</div>
            <div class="reviewlines">{{review.rating}}</div>
            <div class="reviewlines">{{review.comment}}</div>
            <div class="reviewlines">{{review.added_on_date}}</div>
            <div class="reviewlines">{{review.added_on_time}}</div>
            <div class="reviewlines">{{review.rated_by}}</div>
            <hr>
        </div>
        {% endfor %}
        <div id="closeReviewsPopupBtn">Close</div>
    </div>
</div>

<div id="ratePopup">
    <div id="rateWrapper">
        <h3>Rate recipe for {{recipe.recipe_title}}, created by {{recipe.added_by}}</h3>
        <div class="row">
            <form action="{{ url_for('insert_rating', recipe_id=recipe._id, recipe_title=recipe.title) }}" method="POST"
                class="col s12">
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">playlist_add</i>
                        <input id="review_title" name="review_title" type="text" class="validate" required>
                        <label for="review_title">review title</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">playlist_add</i>
                        <input id="rating" name="rating" type="text" class="validate" required>
                        <label for="rating">rating</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">playlist_add</i>
                        <input id="comment" name="comment" type="text" class="validate">
                        <label for="comment">Comment:</label>
                    </div>
                </div>
                <div class="row">
                    <button id="closeRatePopupBtn" class="btn waves-effect waves-light" type="submit" name="action">Send
                        <i class="material-icons right">playlist</i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}